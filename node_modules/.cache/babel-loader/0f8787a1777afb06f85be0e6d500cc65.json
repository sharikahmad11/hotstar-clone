{"ast":null,"code":"\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Index_1 = require(\"./Index\");\n\nvar util_1 = require(\"../../util/util\");\n\nvar Node_1 = require(\"../Node\");\n\nvar LeafNode_1 = require(\"../LeafNode\");\n\nvar nodeFromJSON;\nvar MAX_NODE;\n\nfunction setNodeFromJSON(val) {\n  nodeFromJSON = val;\n}\n\nexports.setNodeFromJSON = setNodeFromJSON;\n\nfunction setMaxNode(val) {\n  MAX_NODE = val;\n}\n\nexports.setMaxNode = setMaxNode;\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\n\nvar PriorityIndex =\n/** @class */\nfunction (_super) {\n  __extends(PriorityIndex, _super);\n\n  function PriorityIndex() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * @inheritDoc\n   */\n\n\n  PriorityIndex.prototype.compare = function (a, b) {\n    var aPriority = a.node.getPriority();\n    var bPriority = b.node.getPriority();\n    var indexCmp = aPriority.compareTo(bPriority);\n\n    if (indexCmp === 0) {\n      return util_1.nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  };\n  /**\n   * @inheritDoc\n   */\n\n\n  PriorityIndex.prototype.isDefinedOn = function (node) {\n    return !node.getPriority().isEmpty();\n  };\n  /**\n   * @inheritDoc\n   */\n\n\n  PriorityIndex.prototype.indexedValueChanged = function (oldNode, newNode) {\n    return !oldNode.getPriority().equals(newNode.getPriority());\n  };\n  /**\n   * @inheritDoc\n   */\n\n\n  PriorityIndex.prototype.minPost = function () {\n    return Node_1.NamedNode.MIN;\n  };\n  /**\n   * @inheritDoc\n   */\n\n\n  PriorityIndex.prototype.maxPost = function () {\n    return new Node_1.NamedNode(util_1.MAX_NAME, new LeafNode_1.LeafNode('[PRIORITY-POST]', MAX_NODE));\n  };\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n\n\n  PriorityIndex.prototype.makePost = function (indexValue, name) {\n    var priorityNode = nodeFromJSON(indexValue);\n    return new Node_1.NamedNode(name, new LeafNode_1.LeafNode('[PRIORITY-POST]', priorityNode));\n  };\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n\n\n  PriorityIndex.prototype.toString = function () {\n    return '.priority';\n  };\n\n  return PriorityIndex;\n}(Index_1.Index);\n\nexports.PriorityIndex = PriorityIndex;\nexports.PRIORITY_INDEX = new PriorityIndex();","map":{"version":3,"sources":["../src/core/snap/indexes/PriorityIndex.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;AAcG;;;;;;;;;;;;;;;;;;;;;;;;;;AAEH,IAAA,OAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AACA,IAAA,MAAA,GAAA,OAAA,CAAA,iBAAA,CAAA;;AACA,IAAA,MAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AACA,IAAA,UAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AAEA,IAAI,YAAJ;AACA,IAAI,QAAJ;;AAEA,SAAA,eAAA,CAAgC,GAAhC,EAAqD;AACnD,EAAA,YAAY,GAAG,GAAf;AACD;;AAFD,OAAA,CAAA,eAAA,GAAA,eAAA;;AAIA,SAAA,UAAA,CAA2B,GAA3B,EAAoC;AAClC,EAAA,QAAQ,GAAG,GAAX;AACD;;AAFD,OAAA,CAAA,UAAA,GAAA,UAAA;AAIA;;;;AAIG;;AACH,IAAA,aAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAmC,EAAA,SAAA,CAAA,aAAA,EAAA,MAAA,CAAA;;AAAnC,WAAA,aAAA,GAAA;;AA2DC;AA1DC;;AAEG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAA,UAAQ,CAAR,EAAsB,CAAtB,EAAkC;AAChC,QAAM,SAAS,GAAG,CAAC,CAAC,IAAF,CAAO,WAAP,EAAlB;AACA,QAAM,SAAS,GAAG,CAAC,CAAC,IAAF,CAAO,WAAP,EAAlB;AACA,QAAM,QAAQ,GAAG,SAAS,CAAC,SAAV,CAAoB,SAApB,CAAjB;;AACA,QAAI,QAAQ,KAAK,CAAjB,EAAoB;AAClB,aAAO,MAAA,CAAA,WAAA,CAAY,CAAC,CAAC,IAAd,EAAoB,CAAC,CAAC,IAAtB,CAAP;AACD,KAFD,MAEO;AACL,aAAO,QAAP;AACD;AACF,GATD;AAWA;;AAEG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,WAAA,GAAA,UAAY,IAAZ,EAAsB;AACpB,WAAO,CAAC,IAAI,CAAC,WAAL,GAAmB,OAAnB,EAAR;AACD,GAFD;AAIA;;AAEG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,mBAAA,GAAA,UAAoB,OAApB,EAAmC,OAAnC,EAAgD;AAC9C,WAAO,CAAC,OAAO,CAAC,WAAR,GAAsB,MAAtB,CAA6B,OAAO,CAAC,WAAR,EAA7B,CAAR;AACD,GAFD;AAIA;;AAEG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAA,YAAA;AACE,WAAQ,MAAA,CAAA,SAAA,CAAkB,GAA1B;AACD,GAFD;AAIA;;AAEG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAA,YAAA;AACE,WAAO,IAAI,MAAA,CAAA,SAAJ,CAAc,MAAA,CAAA,QAAd,EAAwB,IAAI,UAAA,CAAA,QAAJ,CAAa,iBAAb,EAAgC,QAAhC,CAAxB,CAAP;AACD,GAFD;AAIA;;;;AAIG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,QAAA,GAAA,UAAS,UAAT,EAA0B,IAA1B,EAAsC;AACpC,QAAM,YAAY,GAAG,YAAY,CAAC,UAAD,CAAjC;AACA,WAAO,IAAI,MAAA,CAAA,SAAJ,CAAc,IAAd,EAAoB,IAAI,UAAA,CAAA,QAAJ,CAAa,iBAAb,EAAgC,YAAhC,CAApB,CAAP;AACD,GAHD;AAKA;;AAEG;;;AACH,EAAA,aAAA,CAAA,SAAA,CAAA,QAAA,GAAA,YAAA;AACE,WAAO,WAAP;AACD,GAFD;;AAGF,SAAA,aAAA;AAAC,CA3DD,CAAmC,OAAA,CAAA,KAAnC,CAAA;;AAAa,OAAA,CAAA,aAAA,GAAA,aAAA;AA6DA,OAAA,CAAA,cAAA,GAAiB,IAAI,aAAJ,EAAjB","sourcesContent":["/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { NamedNode, Node } from '../Node';\nimport { LeafNode } from '../LeafNode';\n\nlet nodeFromJSON: (a: any) => Node;\nlet MAX_NODE: Node;\n\nexport function setNodeFromJSON(val: (a: any) => Node) {\n  nodeFromJSON = val;\n}\n\nexport function setMaxNode(val: Node) {\n  MAX_NODE = val;\n}\n\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nexport class PriorityIndex extends Index {\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const aPriority = a.node.getPriority();\n    const bPriority = b.node.getPriority();\n    const indexCmp = aPriority.compareTo(bPriority);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return !node.getPriority().isEmpty();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return !oldNode.getPriority().equals(newNode.getPriority());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    return new NamedNode(MAX_NAME, new LeafNode('[PRIORITY-POST]', MAX_NODE));\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: any, name: string): NamedNode {\n    const priorityNode = nodeFromJSON(indexValue);\n    return new NamedNode(name, new LeafNode('[PRIORITY-POST]', priorityNode));\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.priority';\n  }\n}\n\nexport const PRIORITY_INDEX = new PriorityIndex();\n"]},"metadata":{},"sourceType":"script"}